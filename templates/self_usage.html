{% extends "index.html" %}
{% block body %}

<div class="block block-details">
    <div style="padding-left:13px;">
        {% if self_data %}
            <h3>{{ word('welcome', session['lang']) }} {{session['user']}}</h3>
        {% endif %}
        {% if not self_data %}
            <a href="{{ url_for('profile', user=user) }}">{{ word('profile', session['lang']) }}: {{user}}</a>
        {% endif %}
    </div>
    <div style="padding-left:13px;">
        {{ '{0}: {1} ({2} + {3})'.format(word('quota', session['lang']),
        seconds_to_time(session['quota']['total']),
        seconds_to_time(session['quota']['value']),
        seconds_to_time(session['quota']['bonus'])) }}
    </div>
    <div style="float:left;margin-left:13px; margin-right:5px; height: 18px; width: 700px; border:1px solid #194373;">
        <div style="height:18px; width: {{(7 * regular)}}px; background-color:#4780C2;"/></div>
    </div>
    <div style="padding-left:13px; font-weight : bold; font-size : 12pt; color : black;">
        {{'%.2f' % regular}} %
    </div>
    <div style="clear:both;padding-left:13px;">
        {{ word('quota_consumed', session['lang']) }}: {{seconds_to_time(session['consumed'])}}
    </div>
    <div style="padding-left:13px;">
        {{ word('remain', session['lang']) }}: {{seconds_to_time(session['quota']['total'] - session['consumed'])}}
    </div>
</div>
{% if session['quota']['roaming'] > 1 %}
<div class="block block-details">
    <div style="padding-left:13px;">
        <h3>Roaming</h3>
    </div>
    <div style="padding-left:13px;">
        {{ '{0}: {1}'.format(word('quota', session['lang']),
        seconds_to_time(session['quota']['roaming'])) }}
    </div>
    <div style="float:left;margin-left:13px; margin-right:5px; height: 18px; width: 700px; border:1px solid #194373;">
        <div style="height:18px; width: {{(7 * roaming)}}px; background-color:#4780C2;"/></div>
    </div>
    <div style="padding-left:13px; font-weight : bold; font-size : 12pt; color : black;">
        {{'%.2f' % roaming}} %
    </div>
    <div style="clear:both;padding-left:13px;">
        {{ word('quota_consumed', session['lang']) }}: {{seconds_to_time(session['roaming'])}}
    </div>
    <div style="padding-left:13px;">
        {{ word('remain', session['lang']) }}: {{seconds_to_time(session['quota']['roaming'] - session['roaming'])}}
    </div>
</div>
{% endif %}

<form action="" method="POST">
    <input type="submit" value="{{ word('less_details', session['lang']) if showing_details else word('more_details', session['lang'])}}"/>
</form>

{% if showing_details %}
<table class="table">
    <tr>
        <td class="td header", colspan="2">ID</td>
        {% for h in session['headers'] %}
            <td class="td header", colspan="{{len(h)}}">{{h}}</td>
        {% endfor %}
    </tr>
    {% for (i, (phone, stt, stp, consumed)) in enumerate(session['details']) %}
        <tr>
            <td class="data" colspan="2"> {{i + 1}} </td>
            <td class="data" colspan="{{len(session['headers'][0])}}"> {{phone}} </td>
            <td class="data" colspan="{{len(session['headers'][1])}})"> {{stt}} </td>
            <td class="data" colspan="{{len(session['headers'][2])}})"> {{stp}} </td>
            <td class="data" colspan="{{len(session['headers'][3])}})"> {{consumed}} </td>
            {% if session['roles']['is_root'] or session['roles']['is_admin'] %}
            <td class="data">
                <form action="{{ url_for('delete', user=user, phone=phone, consumed=consumed, group=group) }}" method="GET">
                    <input type="submit" value="{{ word('force', session['lang']) }}" name="delete"/>
                </form>
            </td>
            {% endif %}
        </tr>
    {% endfor %}    
    </table>
{% endif %}

{% endblock %}